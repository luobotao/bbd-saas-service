<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bbd.saas.dao.mysql.OrderLogDao">
    <resultMap id="baseResultMap" type="com.bbd.saas.models.OrderLog">
        <result column="id" property="id" jdbcType="INTEGER"/>
        <result column="orderNo" property="orderNo" jdbcType="VARCHAR"/>
        <result column="mailNum" property="mailNum" jdbcType="VARCHAR"/>
        <result column="operTime" property="operTime" jdbcType="TIMESTAMP"/>
        <result column="status" property="status" jdbcType="INTEGER"/>
        <result column="areaCode" property="areaCode" jdbcType="VARCHAR"/>
    </resultMap>
    
    <sql id="baseColumnList">
    	id,
    	areaCode,
		orderNo,
		mailNum，
	    date，
		status
    </sql>
    <!-- 插入一条记录  开始  --> 
    <insert id="insert" useGeneratedKeys="true" keyProperty="id" parameterType="com.bbd.saas.models.OrderLog" >
        INSERT INTO `OrderLog`(
        <include refid="baseColumnList"/>
        )
        VALUES (
	        #{id},
            #{areaCode},
			#{orderNo},
			#{mailNum},
			#{operTime},
			#{status}
        )
    </insert>
    <!-- 插入一条记录  结束  -->
    <!-- 根据站点和时间统计不同状态的订单数目  开始   -->
    <select id="selectCountByAreaCodeAndTime" resultType="java.util.HashMap">
        SELECT `status`, COUNT(*) num FROM `OrderLog`
        <where>
            <if test="areaCode != null and areaCode != ''" >
                areaCode = #{areaCode }
            </if>
            <if test="startDate != null and startDate != ''" >
                <![CDATA[
                    AND operTime >= CONCAT(#{startDate},' 00:00:00')
                    AND operTime <= CONCAT(#{endDate},' 23:59:59')
                ]]>
            </if>
        </where>
        GROUP BY `status`
    </select>
    <!-- 根据站点和时间统计不同状态的订单数目  结束   -->


</mapper>
